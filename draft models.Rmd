---
title: "messing around"
author: "Ricky Heinrich & Vimaljeet Singh"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Goal:
Predict the number of bikes rented per hour, given predictors:
- time of day
- time of year
- weather
- etc

Models to investigate:
- lm
- poisson glm
- decision trees, random forests
- non parametric
- ?

How to decide which model is best:
- BIC
- MSE
- training values vs testing values
- ?

Which predictor is most important?
- find out via p-values ?
- gini index in random forest
- ?


## setting up data
```{r, echo=FALSE, results='hide', include=FALSE}
library(tidyverse)
library(ggplot2)
df <- read_csv("Bike-Sharing-Dataset/hour.csv")
df$rawtemp = df$temp*47-8 # converting temp to raw form
df$rawatemp = df$atemp*66-16 # converting atemp to raw
df$rawhum = df$hum*100 # converting hum to raw form
df$rawwindspeed = df$windspeed*67 # converting windspeed to raw form 

colnames(df)
```
# Removing variables I don't care about
```{r}
min_df <- subset(df, select = -c(instant, dteday, yr,temp, atemp, hum, windspeed))

# converting some to factors
# columns that should be factors
cols <- c("season", "mnth", "hr","holiday","weekday","workingday","weathersit")
min_df[,cols] <- data.frame(apply(min_df[cols], 2, as.factor))

# setting levels of factors
levels(min_df$season) <- c("winter", "spring", "summer", "fall")
levels(min_df$mnth) <- c("Jan", "Feb", "Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
levels(min_df$holiday) <- c("Not Holiday", "Holiday")
levels(min_df$weekday) <- c("Sun","Mon","Tues","Wed","Thurs","Fri","Sat")
levels(min_df$workingday) <- c("Not working day", "Working day")
levels(min_df$weathersit) <- c("Clear","Misty","Light precip", "heavy precip")
```

Need to make sure stuff is factoring properly .... like that when it factors the levels mean the same thing I think they mean, so we don't fuck up analysis later. I forget the code to double check the matching of the levels and factors 

## Need to split train/test like you did oops

## linear regression ?
```{r}
# response variable full count, removing casual and registered
# could do another model with just casual then just registered to see if the variables affect them differently
lmmod <- lm(cnt~.-casual -registered, data = min_df)
summary(lmmod)
```
How to we interpret this intercept? Like if all the betas are 0, we get than intercept, does that mean all the binary variables that have 0s in them are the only ones that are 'inplace' ?

I don't know why workingday is showing as NA, something going wrong somewhere. It looks like a lot of variables are significant, F test coming up with tiny p-value (need to double check how to interpret that). All hours are significant but not all months ... kinda funny. Also unsure how to interpret like if january has effect, or any of the 'first' factors. 

Should run the tests from John's class to see if linear model fits, like nmpreg or whatever. Run diagnostics too, show normality conditions don't hold.

Show predicted values come out negative (Vimal shows this)

Should we do cross validation? 

## random forest decision tree?

What are the assumptions of random forest again ?
```{r}

```

## see if we can do one of those spline things or non parametrics since they are john's fav


